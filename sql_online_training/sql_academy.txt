Решения на задания онлайн-тренажера https://sql-academy.org/ru/trainer?sort=byId
Задание 1
Вывести имена всех когда-либо обслуживаемых пассажиров авиакомпаний
Поля в результирующей таблице:
name
Решение:
SELECT name FROM Passenger
__________________________________________________________________________________________	
Задание 2
Вывести названия всеx авиакомпаний
Поля в результирующей таблице:
name
Решение:
SELECT name FROM Company
___________________________________________________________________________________________
Задание 3
Вывести все рейсы, совершенные из Москвы
Поля в результирующей таблице:
*
Решение:
SELECT * FROM Trip
WHERE town_from = 'Moscow'
___________________________________________________________________________________________
Задание 4
Вывести имена людей, которые заканчиваются на "man"
Поля в результирующей таблице:
name	
Решение:
SELECT name FROM Passenger
WHERE name LIKE '%man'
____________________________________________________________________________________________
Задание 5
Вывести количество рейсов, совершенных на TU-134
Поля в результирующей таблице:
count
!!Используйте конструкцию "as count" для агрегатной функции подсчета количества рейсов. Это необходимо для корректной проверки.
Решение:
SELECT COUNT(plane)  AS count FROM trip
WHERE plane = 'TU-154'
___________________________________________________________________________________________
Задание 6
Какие компании совершали перелеты на Boeing
Поля в результирующей таблице:
name
Решение:
SELECT DISTINCT  name FROM Company
INNER JOIN Trip ON Trip.company = Company.id
WHERE plane = 'Boeing'
___________________________________________________________________________________________
Задание 7
Вывести все названия самолётов, на которых можно улететь в Москву (Moscow)
Поля в результирующей таблице:
plane
Решение:
SELECT DISTINCT  plane FROM Trip
WHERE town_to = 'Moscow'
___________________________________________________________________________________________
Задание 8
В какие города можно улететь из Парижа (Paris) и сколько времени это займёт?
Поля в результирующей таблице:
town_to
flight_time
!!Используйте конструкцию "as flight_time" для вывода необходимого времени. Это необходимо для корректной проверки.
Формат для вывода времени: HH:MM:SS
Решение:
SELECT town_to, TIME(time_in -time_out) AS flight_time FROM Trip
WHERE town_from = 'Paris'
___________________________________________________________________________________________
Задание 9
Какие компании организуют перелеты с Владивостока (Vladivostok)?
Поля в результирующей таблице:
name
Решение:
SELECT name FROM Company
INNER JOIN Trip ON Company.id = Trip.company
WHERE town_from = 'Vladivostok'
___________________________________________________________________________________________
Задание 10
Вывести вылеты, совершенные с 10 ч. по 14 ч. 1 января 1900 г.
Поля в результирующей таблице:
*
Решение:
SELECT *  FROM Trip
WHERE time_out BETWEEN '1900-01-01T10:00:00.000Z' AND  '1900-01-01T14:00:00.000Z'
___________________________________________________________________________________________
Задание 11
Вывести пассажиров с самым длинным именем
Поля в результирующей таблице:
name
Решение:
(изначально LENGTH(name) использовал в SELECT, чтобы проверить количество символов в name)
SELECT name  FROM Passenger
WHERE LENGTH(name)>=20
___________________________________________________________________________________________
Задание 12
Вывести id и количество пассажиров (скорее всего имели ввиду рейсы) для всех прошедших полётов
Поля в результирующей таблице:
trip
count
!!Используйте конструкцию "as count" для агрегатной функции подсчета количества пассажиров. Это необходимо для корректной проверки.
Решение:
SELECT Trip.id AS trip, COUNT(Passenger) AS count  FROM Trip
INNER JOIN Pass_in_trip ON  Trip.id = Pass_in_trip.trip
GROUP BY trip
__________________________________________________________________________________________
Задание 13
Вывести имена людей, у которых есть полный тёзка среди пассажиров
Поля в результирующей таблице:
name
Решение:
SELECT name FROM Passenger
GROUP BY name
HAVING  COUNT(name)>1 
__________________________________________________________________________________________
Задание 14
В какие города летал Bruce Willis
Поля в результирующей таблице:
town_to
Решение:
SELECT town_to  FROM Trip
INNER JOIN Pass_in_trip ON Trip.id = Pass_in_trip.trip
INNER JOIN Passenger ON Passenger.id = Pass_in_trip.passenger
WHERE name = 'Bruce Willis'
__________________________________________________________________________________________
Задание 15
Во сколько Стив Мартин (Steve Martin) прилетел в Лондон (London)
Поля в результирующей таблице:
time_in
Решение:
SELECT time_in FROM Trip
INNER JOIN Pass_in_trip ON Trip.id = Pass_in_trip.trip
INNER JOIN Passenger ON Passenger.id = Pass_in_trip.passenger
WHERE name = 'Steve Martin' AND town_to = 'London'
___________________________________________________________________________________________


___________________________________________________________________________________________


__________________________________________________________________________________________


__________________________________________________________________________________________	
